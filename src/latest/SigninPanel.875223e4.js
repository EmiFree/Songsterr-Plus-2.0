import{d as e,h as t,y as s,b as i}from"./preact.272910a2.js";import{_ as o,p as a,q as r,N as l,b_ as n,L as c}from"./index.b0563877.js";import{A as p}from"./ActionButton.3e8facf6.js";import{I as d}from"./Input.d3dc4ead.js";import{v as g,e as h,p as m,F as u}from"./FormError.15baa318.js";import{a as f}from"./user.9b07dcdf.js";import{g as N,a as S,s as y}from"./google.20e6aa6a.js";import{P as w}from"./Panel.d80d9593.js";class v extends e{render(){let e=this.props.className;return t("svg",{width:40,height:40,viewBox:"0 0 26 26",className:e},t("g",{fill:"none",fillRule:"evenodd"},t("rect",{width:"26",height:"26",fill:"#FFF",rx:"2"}),t("g",{fill:"#000"},t("path",{fill:"#EA4335",d:"M13 7.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C17.46 4.89 15.43 4 13 4 9.48 4 6.44 6.02 4.96 8.96l2.91 2.26C8.6 9.05 10.62 7.48 13 7.48z"}),t("path",{fill:"#4285F4",d:"M21.64 13.2c0-.74-.06-1.28-.19-1.84H13v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z"}),t("path",{fill:"#FBBC05",d:"M7.88 14.78a5.54 5.54 0 0 1-.3-1.78c0-.62.11-1.22.29-1.78L4.96 8.96A9.008 9.008 0 0 0 4 13c0 1.45.35 2.82.96 4.04l2.92-2.26z"}),t("path",{fill:"#34A853",d:"M13 22c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74l-2.91 2.26C6.45 19.98 9.48 22 13 22z"}),t("path",{fill:"none",d:"M4 4h18v18H4z"}))))}}let $=e=>{let{onClick:s,processing:i,disabled:l,title:n,id:c}=e;return t("button",{id:c,className:o.google,onClick:s,disabled:l||i},i&&t(a,{width:25,height:20,fill:"#fff",className:r.google}),!i&&t(v,{className:o.googleIcon}),t("span",null,n))},b="Cou30y",q="Cou1l3",x="Cou1l3 Cou2at",P="Cou2xu",_="Cou1l3 Coubs",G="Cou1kb",C="Cou1l3 Cou26q",I="Cou1b8",A="Cou1l3 Couf6",D="Cou1l3 Cou2fe",E={title:"Cou30y",section:"Cou1l3",sectionGoogle:"Cou1l3 Cou2at",separator:"Cou2xu",sectionSignin:"Cou1l3 Coubs",actions:"Cou1kb",sectionCouponNotice:"Cou1l3 Cou26q",notice:"Cou1b8",sectionForgotPassword:"Cou1l3 Couf6",sectionCreateAccount:"Cou1l3 Cou2fe"};class F extends e{email=s();password=s();state={error:null,processing:!1,googleError:null,googleInitialized:!1,googleProcessing:!1};componentDidMount(){N().then(()=>{this.setState({googleInitialized:!0})})}redirect=()=>{var e;if(null===(e=this.props.query.next)||void 0===e?void 0:e.includes("/mailer/")){window.location.replace(window.location.origin+this.props.query.next);return}this.props.dispatch("navigate",n(this.props.query))};handleSignin=async e=>{e.preventDefault();let t=this.email&&this.email.current,s=this.password&&this.password.current;if(t&&s)try{g([{field:t,validator:h},{field:s,validator:m},]),this.setState({processing:!0,error:null});let i=await f(t.value,s.value);this.props.dispatch("user/signIn",i),this.setState({processing:!1,error:null}),this.redirect()}catch(o){this.setState({processing:!1,error:o})}};handleGoogleSignin=async e=>{e.preventDefault();try{this.setState({googleProcessing:!0,googleError:null});let t=await S();this.props.dispatch("user/googleSignIn",t),this.setState({googleProcessing:!1,googleError:null}),this.redirect()}catch(s){let i=y(s);this.setState({googleProcessing:!1,googleError:i})}};render(){let e=Object.keys(this.props.query).length?`?${new URLSearchParams(this.props.query)}`:"",{googleInitialized:s,googleError:a,googleProcessing:r}=this.state,l=this.props.query&&"coupon"===this.props.query.next,n=t("section",{className:E.sectionCouponNotice,"data-section":"coupon-notice"},t("p",{className:E.notice},"Please sign in to your account or sign up for free to activate your coupon code."));return t(w,{title:"Sign In",id:this.props.id},t(i,null,l&&n,t("section",{className:E.sectionGoogle,"data-section":"google"},t("form",{noValidate:!0,onSubmit:this.handleGoogleSignin},t(u,{error:a}),t($,{id:"google-signin",title:s?"Sign in with Google":"Loading...",onClick:this.handleGoogleSignin,processing:r,disabled:!s}))),t("section",{className:E.sectionSignin,"data-section":"signin"},t("div",{className:E.separator},t("span",null,"OR")),t("form",{noValidate:!0,onSubmit:this.handleSignin,action:""},t(u,{error:this.state.error}),t(d,{ref:this.email,name:"email",type:"email",label:"Email",autocomplete:"email",error:this.state.error}),t(d,{ref:this.password,name:"password",type:"password",label:"Password",autocomplete:"current-password",error:this.state.error}),t("div",{className:E.actions},t(p,{id:"signin",title:"Sign in",processing:this.state.processing})))),t("section",{className:E.sectionForgotPassword,"data-section":"forgot"},t(c,{to:"/a/wa/forgotPassword"},"Forgot your password?")),t("section",{className:E.sectionCreateAccount,"data-section":"signup"},t("h3",{className:E.title},"Don't have an account?"),t(c,{to:"/a/wa/signup"+e,id:"create_acc",className:o.buttonGreen},"Sign up for a free account"))))}}var k=l(F,"query");export{k as default}