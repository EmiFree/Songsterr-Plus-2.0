import{H as a,I as e,bY as t,L as s,u as i,bW as r,bX as o,a as n}from"./index.3637aaf7.js";import{a as c,p as l,v as d,m as u,A as m}from"./preact.f8a34c73.js";import{n as p}from"./ActionButton.e7edc72b.js";import{v as g,f as h,l as f,x as v}from"./FormError.ba736668.js";import{d as N}from"./Input.4b13d914.js";import{l as C,f as b}from"./user.804c31aa.js";import{c as y}from"./google.04041246.js";import{w as P}from"./Panel.4e04b14d.js";function S(){const{dispatch:a}=i(),[e,t]=u(!1),[s,o]=u(null),n=m((async e=>{o(null),t(!0),e.preventDefault();try{a("user/profile",await r()),a("curiosity/conversion",{event:"Activated android promo"})}catch(e){o(e),a("curiosity/error",{error:"Android Promo",message:e.message})}t(!1)}),[]);return d("form",{noValidate:!0,onSubmit:n,action:""},d(v,{error:s}),d("div",{className:"Bok2qu"},d(p,{id:"startAndroidPromo",title:"Start free trial",processing:e})))}const k={badge:"Bpz1tm",badgePlus:"Bpz1tm Bpzg8",badgePlusExtended:"Bpz1tm Bpz2gy",badgeFree:"Bpz1tm Bpz1d",badgeAndroidLifetime:"Bpz1tm Bpz2j1",header:"Bpz1a9",secondary:"Bpzoo",primary:"Bpz1mu",footer:"Bpz2d3",icon:"Bpz32k",text:"Bpz171",button:n+" Bpz1dt"};function A(a){let{onClick:e}=a;return d("div",{className:k.badgeFree},d("div",{className:k.header},d("img",{src:"/static/media/devices.a3e3d850.svg",className:k.icon,width:149,height:66}),d("div",{className:k.text,id:"account-type"},d("span",{className:k.secondary},"ACCOUNT TYPE"),d("span",{className:k.primary},"FREE"))),d("div",{className:k.footer,id:"account-meta"},d(s,{to:"/a/wa/plus",className:k.button,onClick:e},"Upgrade to PLUS")))}function w(a){let{isCanceled:e,isMonthTrial:t}=a;const s=e||t;return d("div",{className:s?k.badgePlusExtended:k.badgePlus},d("div",{className:k.header},d("div",{className:k.header},d("img",{src:"/static/media/plus.57c4d40a.svg",className:k.icon,width:144,height:73}),d("div",{className:k.text,id:"account-type"},d("span",{className:k.secondary},"ACCOUNT TYPE"),d("span",{className:k.primary},"PLUS"))),s&&d("div",{className:k.footer,id:"account-meta"},e&&d("span",null,d("strong",null,"Canceled.")," Active till the end of the last paid month."),!e&&t&&d("span",null,"This is a one month free trial."))))}function x(){const{experiments:a}=i("experiments");return d("div",{className:k.badgeAndroidLifetime},d("div",{className:k.header},d("img",{src:"/static/media/android.181a8323.svg",className:k.icon,width:86,height:65}),d("div",{className:k.text,id:"account-type"},d("span",{className:k.secondary},"ACCOUNT TYPE"),d("span",{className:k.primary},"Android"),d("span",{className:k.primary},"Lifetime"))),d("div",{className:k.footer,id:"account-meta"},d("span",null,"You have all the features unlocked for the ",d("a",{href:o("android",a,"android_lifetime")},"Songsterr Android")," app.")))}var z=a(class extends c{constructor(a){super(a),e(this,"name",l()),e(this,"email",l()),e(this,"onUpgradeClick",(()=>{this.props.dispatch("curiosity/setConversionProps",{"Last referring link":"AccountPanel Upgrade Link"})})),e(this,"handleSignOut",(async a=>{a.preventDefault();try{this.setState({signoutProcessing:!0,signoutError:null}),await C(),this.props.dispatch("user/signOut"),y(),this.setState({signoutProcessing:!1,signoutError:null}),this.props.dispatch("navigate","/a/wa/signin")}catch(a){this.setState({signoutProcessing:!1,signoutError:a})}})),e(this,"handleSave",(async a=>{a.preventDefault();const e=this.name.current,t=this.email.current;try{g([{field:e,validator:h},{field:t,validator:f}]),this.setState({processing:!0,error:null});const a=await b(e.value,t.value);this.props.dispatch("user/profile",a),this.setState({processing:!1,error:null})}catch(a){this.setState({processing:!1,error:a})}})),this.state={error:null,processing:!1,signoutError:null,signoutProcessing:!1}}render(){t();const{hasPlus:a,hasSubscription:e,isLoggedIn:i,profile:r}=this.props.user;if(!i)return d(P,{title:"Account",id:"account"},d("div",{className:"Panel-inner"}));const{planCancelDate:o,planEndDate:n,name:c,email:l,isLegacyPayPal:u,isAndroidLifetime:m,plan:g}=r,h=m&&!a?"Android Lifetime":g,f=m&&!a,C=m&&a&&!r.subscription,b=e&&!o,y=a&&n;return d(P,{title:"Account",id:this.props.id},d("div",{className:"Panel-inner"},d("section",{className:"C9u2j5 C9u2nk","data-section":"update"},d("form",{noValidate:!0,onSubmit:this.handleSave,action:""},d(v,{error:this.state.error}),d(N,{type:"text",label:"Name",ref:this.name,name:"name",defaultValue:c,error:this.state.error,autocomplete:"name"}),d(N,{type:"email",label:"Email",ref:this.email,name:"email",defaultValue:l,error:this.state.error,autocomplete:"email"}),d("div",{className:"C9u1mb"},d(p,{title:"Save",processing:this.state.processing}))),d(s,{to:"/a/wa/account/password",className:"C9u2gr","data-link":"password"},"Change password")),d("section",{className:"C9u2j5 C9u9g","data-section":"profile"},"Android Lifetime"===h&&d(x,null),"FREE"===h&&d(A,{onClick:this.onUpgradeClick}),"PLUS"===h&&d(w,{isCanceled:y,isMonthTrial:C}),f&&d("div",{className:"C9ueb C9uk4",id:"account-android-notice"},d(s,{id:"upgradeFromAndroid",to:"/a/wa/plus",onClick:this.onUpgradeClick},"Upgrade to PLUS")," to get all the features across all the platforms, or start a one month free trial.",d(S,null)),b&&d(s,{id:"cancelSubscription",to:"/a/wa/account/subscription",className:"C9u2gr","data-link":"cancel"},"Cancel subscription")),e&&!o&&!u&&d("section",{className:"C9u2j5 C9u1d4","data-section":"card"},d("div",{className:"C9u1q2"},d("div",{className:"C9uxb"},d("div",{className:"C9u1zy","data-value":"card"},"XXXX-XXXX-XXXX-XXXX"),d("div",{className:"C9u2x0"},d(s,{id:"updateCardLink",to:"/a/wa/account/card","data-link":"card"},"Update card"))))),d("section",{className:"C9u2j5 C9uur","data-section":"privacy"},d("p",{className:"C9u2bk"},"EXPORT"),d("p",{className:"C9ueb","data-label":"privacy-notice"},"You are in control of the content in your Songsterr account, even if you stop using Songsterr or decide to delete your account altogether."),d("a",{id:"exportPersonalData",className:"C9u2gr",target:"_blank",href:"/api/privacy/data","data-link":"export"},"Download my data (JSON)"),!a&&d(s,{to:"/a/wa/account/deactivate",className:"C9u2gr","data-link":"deactivate"},"Deactivate my account")),d("section",{className:"C9u2vz","data-section":"signout"},d("form",{noValidate:!0,onSubmit:this.handleSignOut},d(p,{id:"signout",title:"Sign out",processing:this.state.signoutProcessing})))))}},"user","experiments");export{z as default};
//# sourceMappingURL=AccountPanel.4ce5ba79.js.map
