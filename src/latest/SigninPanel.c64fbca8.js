import{d as e,a as o,e as t,c as s}from"./preact.3d326435.js";import{f as i,h as a,j as n,w as r,c4 as l,R as c,bO as u,c5 as g,k as p,Q as d,L as h}from"./index.c64a48b4.js";import{A as f}from"./ActionButton.3cab06c5.js";import{I as m}from"./Input.33ac2f73.js";import{a as C}from"./user.0e209c5e.js";import{g as S,a as w,s as v}from"./google.5e7db2d1.js";import{P as y}from"./Panel.7e25754f.js";class IconGoogle extends e{render(){let e=this.props.className;return o("svg",{width:40,height:40,viewBox:"0 0 26 26",className:e},o("g",{fill:"none",fillRule:"evenodd"},o("rect",{width:"26",height:"26",fill:"#FFF",rx:"2"}),o("g",{fill:"#000"},o("path",{fill:"#EA4335",d:"M13 7.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C17.46 4.89 15.43 4 13 4 9.48 4 6.44 6.02 4.96 8.96l2.91 2.26C8.6 9.05 10.62 7.48 13 7.48z"}),o("path",{fill:"#4285F4",d:"M21.64 13.2c0-.74-.06-1.28-.19-1.84H13v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z"}),o("path",{fill:"#FBBC05",d:"M7.88 14.78a5.54 5.54 0 0 1-.3-1.78c0-.62.11-1.22.29-1.78L4.96 8.96A9.008 9.008 0 0 0 4 13c0 1.45.35 2.82.96 4.04l2.92-2.26z"}),o("path",{fill:"#34A853",d:"M13 22c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74l-2.91 2.26C6.45 19.98 9.48 22 13 22z"}),o("path",{fill:"none",d:"M4 4h18v18H4z"}))))}}let GoogleSignInButton=e=>{let{onClick:t,processing:s,disabled:r,title:l,id:c}=e;return o("button",{id:c,className:i.google,onClick:t,disabled:r||s},s&&o(a,{width:25,height:20,fill:"#fff",className:n.google}),!s&&o(IconGoogle,{className:i.googleIcon}),o("span",null,l))},title="Cou30y",section="Cou1l3",sectionGoogle="Cou1l3 Cou2at",separator="Cou2xu",sectionSignin="Cou1l3 Coubs",actions="Cou1kb",sectionCouponNotice="Cou1l3 Cou26q",notice="Cou1b8",sectionForgotPassword="Cou1l3 Couf6",sectionCreateAccount="Cou1l3 Cou2fe",__default={title:"Cou30y",section:"Cou1l3",sectionGoogle:"Cou1l3 Cou2at",separator:"Cou2xu",sectionSignin:"Cou1l3 Coubs",actions:"Cou1kb",sectionCouponNotice:"Cou1l3 Cou26q",notice:"Cou1b8",sectionForgotPassword:"Cou1l3 Couf6",sectionCreateAccount:"Cou1l3 Cou2fe"};var de={translations:{"":{"Don't have an account?":["Du hast noch kein Konto?"],Email:["E-Mail"],"Forgot your password?":["Passwort vergessen?"],"Loading...":["Lade..."],OR:["ODER"],Password:["Passwort"],"Please sign in to your account or sign up for free to activate your coupon code.":["Bitte melden Sie sich bei Ihrem Konto an oder registrieren Sie sich kostenlos, um Ihren Gutscheincode zu aktivieren."],"Sign in":["Anmelden"],"Sign in with Google":["Anmelden mit Google"],"Sign up for a free account":["Registrieren Sie sich f\xfcr ein kostenloses Konto"]}},language:"de",pluralForms:"nplurals=2; plural=(n != 1);"},es=null,fr={translations:{"":{"Don't have an account?":["Vous n'avez pas de compte\xa0?"],Email:["Courriel"],"Forgot your password?":["Mot de passe oubli\xe9\xa0?"],"Loading...":["Chargement..."],OR:["OU"],Password:["Mot de passe"],"Please sign in to your account or sign up for free to activate your coupon code.":["Veuillez vous connecter \xe0 votre compte ou vous inscrire gratuitement pour activer votre code promo."],"Sign in":["Se connecter"],"Sign in with Google":["Connectez-vous avec Google"],"Sign up for a free account":["Inscrivez-vous pour un compte gratuit"]}},language:"fr",pluralForms:"nplurals=2; plural=(n > 1);"},it=null,ja=null,ko=null,pt=null,ru=null,zh=null,locales=[de,es,fr,it,ja,ko,pt,ru,zh];class SigninPanel extends e{email=t();password=t();state={error:null,processing:!1,googleError:null,googleInitialized:!1,googleProcessing:!1};componentDidMount(){S().then(()=>{this.setState({googleInitialized:!0})})}redirect=()=>{if(this.props.query.next?.includes("/mailer/")){window.location.replace(window.location.origin+this.props.query.next);return}this.props.dispatch("navigate",l(this.props.query))};handleSignin=async e=>{e.preventDefault();let o=this.email&&this.email.current,t=this.password&&this.password.current;if(o&&t)try{c([{field:o,validator:u},{field:t,validator:g}]),this.setState({processing:!0,error:null});let e=await C(o.value,t.value);this.props.dispatch("user/signIn",e),this.setState({processing:!1,error:null}),this.redirect()}catch(e){this.setState({processing:!1,error:e})}};handleGoogleSignin=async e=>{e.preventDefault();try{this.setState({googleProcessing:!0,googleError:null});let e=await w();this.props.dispatch("user/googleSignIn",e),this.setState({googleProcessing:!1,googleError:null}),this.redirect()}catch(o){let e=v(o);this.setState({googleProcessing:!1,googleError:e})}};render(){let{gettext:e}=p(locales),t=Object.keys(this.props.query).length?`?${new URLSearchParams(this.props.query)}`:"",{googleInitialized:a,googleError:n,googleProcessing:r}=this.state,l=this.props.query&&"coupon"===this.props.query.next,c=o("section",{className:__default.sectionCouponNotice,"data-section":"coupon-notice"},o("p",{className:__default.notice},e("Please sign in to your account or sign up for free to activate your coupon code.")));return o(y,{title:"Sign In",id:this.props.id},o(s,null,l&&c,o("section",{className:__default.sectionGoogle,"data-section":"google"},o("form",{noValidate:!0,onSubmit:this.handleGoogleSignin},o(d,{error:n}),o(GoogleSignInButton,{id:"google-signin",title:e(a?"Sign in with Google":"Loading..."),onClick:this.handleGoogleSignin,processing:r,disabled:!a}))),o("section",{className:__default.sectionSignin,"data-section":"signin"},o("div",{className:__default.separator},o("span",null,e("OR"))),o("form",{noValidate:!0,onSubmit:this.handleSignin,action:""},o(d,{error:this.state.error}),o(m,{ref:this.email,name:"email",type:"email",label:e("Email"),autocomplete:"email",error:this.state.error}),o(m,{ref:this.password,name:"password",type:"password",label:e("Password"),autocomplete:"current-password",error:this.state.error}),o("div",{className:__default.actions},o(f,{id:"signin",title:e("Sign in"),processing:this.state.processing})))),o("section",{className:__default.sectionForgotPassword,"data-section":"forgot"},o(h,{to:"/a/wa/forgotPassword"},e("Forgot your password?"))),o("section",{className:__default.sectionCreateAccount,"data-section":"signup"},o("h3",{className:__default.title},e("Don't have an account?")),o(h,{to:"/a/wa/signup"+t,id:"create_acc",className:i.buttonGreen},e("Sign up for a free account")))))}}var SigninPanel$1=r(SigninPanel,"query");export{SigninPanel$1 as default};
