import{c6 as t}from"./index.c64a48b4.js";import{b as e,c as i}from"./user.0e209c5e.js";async function gapiInit(){window.__INITIALIZED_GAPI__||(await t("https://apis.google.com/js/client.js","__LOADED_GAPI__"),await new Promise((t,e)=>{if(!window.gapi)return e(Error("No window.gapi"));window.gapi.load("client:auth2",{callback(){setTimeout(function(){if(!window.gapi||!window.gapi.client)return e(Error("No window.gapi.client"));window.__INITIALIZED_GAPI__=!0,window.gapi.client.init({clientId:window.__GOOGLE_CLIENT_ID__,scope:"profile email"}).then(t,e)},1)},onerror:e})}))}async function googleInit(){try{await gapiInit()}catch(t){"idpiframe_initialization_failed"!==t.error&&console.error(t)}}async function googleSignin(){await gapiInit();let t=window.gapi;await t.auth2.getAuthInstance().signIn();let i=t.auth2.getAuthInstance().currentUser.get(),n=i.getAuthResponse().id_token;return e(n)}let DEFAULT="Oops, something went wrong. Please try again later";function shapeGoogleAuthError(t){if(!(t instanceof Error)&&t.error)switch(t.error.toLowerCase()){case"popup_closed_by_user":return null;case"idpiframe_initialization_failed":return t.details?Error(t.details):Error(DEFAULT);case"popup_blocked_by_browser":return Error("Pop-up blocked by browser. Please try again");case"access_denied":return Error("Access was not granted. Please try again");default:return Error(DEFAULT)}return t}async function googleSignout(){try{await gapiInit();let t=window.gapi;t.auth2.getAuthInstance().isSignedIn.get()&&await t.auth2.getAuthInstance().signOut()}catch(t){}}async function googleDeactivate(){await i();try{await gapiInit();let t=window.gapi;t.auth2.getAuthInstance().isSignedIn.get()&&t.auth2.getAuthInstance().currentUser.get().disconnect()}catch(t){}}export{googleSignin as a,googleSignout as b,googleDeactivate as c,googleInit as g,shapeGoogleAuthError as s};
