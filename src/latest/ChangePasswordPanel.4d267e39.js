import{H as s,I as r,L as e,_ as t,T as a}from"./index.3637aaf7.js";import{a as o,p as i,v as n}from"./preact.f8a34c73.js";import{n as p}from"./ActionButton.e7edc72b.js";import{v as c,h as d,g as l,x as u}from"./FormError.ba736668.js";import{d as h}from"./Input.4b13d914.js";import{b as m,m as w}from"./user.804c31aa.js";import{w as f}from"./Panel.4e04b14d.js";import{c as v,o as g}from"./ContinueLink.d187aeb8.js";import{o as b}from"./GenericPanel.module.38dde225.js";var P=s(class extends o{constructor(s){super(s),r(this,"password",i()),r(this,"passwordAgain",i()),r(this,"handleSubmit",(async s=>{s.preventDefault();const r=this.password.current,e=this.passwordAgain.current;try{if(c([{field:r,validator:d},{field:e,validator:s=>l(s,r.value)}]),this.setState({processing:!0,error:null}),this.props.route.isRecover){const s=this.props.query.key||"",e=await m(s,r.value);this.props.dispatch("user/recoverPassword",e)}else{const s=await w(r.value);this.props.dispatch("user/changePassword",s)}this.setState({processing:!1,error:null,next:!0})}catch(s){this.setState({processing:!1,error:s})}})),this.state={error:null,processing:!1,next:!1,errorPassword:"",errorPasswordAgain:""}}render(){const s=n(v,{key:"form",className:b.section},n("h4",{className:b.title},"Please enter your new password."),n("form",{noValidate:!0,onSubmit:this.handleSubmit,action:""},n(u,{error:this.state.error}),n(h,{type:"password",label:"New password",name:"password",ref:this.password,error:this.state.error,autocomplete:"new-password"}),n(h,{type:"password",label:"Once again",name:"passwordAgain",ref:this.passwordAgain,error:this.state.error,autocomplete:"new-password"}),n("div",{className:b.actions},n(p,{title:"Save",processing:this.state.processing}),n(e,{to:this.props.route.isRecover?"/":"/a/wa/account",className:t.buttonLinkFloat},"Cancel")))),r=n(v,{key:"done",className:b.section},n("h4",{className:b.title},"Your password has been changed."),n(g,{href:"/a/wa/account"})),o=this.state.next?r:s,i=this.props.route.isRecover?"Recover Password":"Change Password",c=this.props.route.isRecover?"recoverPassword":"account-password";return n(f,{id:c,title:i},n(a,null,o))}},"user");export{P as default};
//# sourceMappingURL=ChangePasswordPanel.4d267e39.js.map
